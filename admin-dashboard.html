
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>漫画管理后台 | 网站名称</title>
    <link rel="stylesheet" href="admin-style.css">

</head>
<body>
    <!-- 管理后台头部 -->
    <header class="admin-header">
        <div class="admin-container">
            <div class="admin-logo">📚 网站名称 管理后台</div>
            <nav class="admin-nav">
                <a href="#dashboard" class="active" onclick="switchTab('dashboard', this)">仪表板</a>
                <a href="#upload" onclick="switchTab('upload', this)">上传漫画</a>
                <a href="#manga" onclick="switchTab('manga', this)">漫画管理</a>
                <a href="#carousel" onclick="switchTab('carousel', this)">轮播图管理</a>
                <a href="#tags" onclick="switchTab('tags', this)">标签管理</a>
                <a href="#" onclick="logout()">登出</a>
                <a href="/">返回前台</a>
            </nav>
        </div>
    </header>
    <!-- 通知消息 -->
    <div id="notification" class="notification"></div>
    <!-- 主要内容区域 -->
    <main class="admin-main">
        <!-- 仪表板 -->
        <section id="dashboard" class="admin-section tab-content active">
            <h2 class="section-title">仪表板</h2>
            <!-- 统计卡片 -->
            <div class="stats-grid">
                <div class="stat-card stat-primary">
                    <div class="stat-icon">📖</div>
                    <div class="stat-number" id="totalManga">0</div>
                    <div class="stat-label">总漫画数</div>
                </div>
                <div class="stat-card stat-warning">
                    <div class="stat-icon">👁️</div>
                    <div class="stat-number" id="totalVisitors">0</div>
                    <div class="stat-label">总访问量</div>
                </div>
            </div>
            <!-- 最近活动 -->
            <div class="recent-activity">
                <h3>最近活动</h3>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>操作类型</th>
                                <th>漫画名称</th>
                                <th>时间</th>
                            </tr>
                        </thead>
                        <tbody id="recentActivities">
                            <tr>
                                <td colspan="3" class="loading">加载中...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        <!-- 上传漫画 -->
        <section id="upload" class="admin-section tab-content">
            <h2 class="section-title">上传漫画</h2>
            <div id="uploadError" class="error-message"></div>
            <form id="uploadForm">
                <div class="form-group">
                    <label for="mangaTitle">漫画名称 *</label>
                    <input type="text" id="mangaTitle" name="title" required placeholder="请输入漫画名称">
                </div>
                <div class="form-group">
                    <label for="mangaAuthor">作者 *</label>
                    <input type="text" id="mangaAuthor" name="author" required placeholder="请输入作者姓名">
                </div>
                <div class="form-group">
                    <label for="mangaDescription">漫画简介</label>
                    <textarea id="mangaDescription" name="description" placeholder="请输入漫画简介"></textarea>
                </div>
                <!-- 漫画标签 -->
                <div class="form-group">
                    <label for="mangaTags">漫画标签</label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <select id="tagSelect" style="flex: 1;">
                            <option value="">选择标签...</option>
                        </select>
                        <button type="button" class="btn btn-info" onclick="addTagToManga()">添加标签</button>
                    </div>
                    <div id="selectedTags" class="manga-tags" style="margin-top: 10px;">
                        <!-- 标签将动态添加 -->
                    </div>
                </div>
                <div class="optional-cover">
                    <div class="form-group">
                        <label for="cover">封面图片 (可选 - 留空将自动使用CBZ中第一张图片)</label>
                        <div class="upload-area" id="coverUploadArea" onclick="document.getElementById('cover').click()">
                            <i>📁</i>
                            <p>点击上传封面图片 (JPG, PNG, GIF, WebP)</p>
                            <p>或拖拽文件到此处</p>
                        </div>
                        <input type="file" id="cover" name="cover" accept="image/*" style="display: none;">
                        <div id="coverInfo" class="file-info" style="display: none;"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="file">漫画文件 (CBZ/CBR) *</label>
                    <div class="upload-area" id="fileUploadArea" onclick="document.getElementById('file').click()">
                        <i>📚</i>
                        <p>点击上传漫画文件</p>
                        <p>支持 CBZ, CBR, ZIP, RAR 格式</p>
                    </div>
                    <input type="file" id="file" name="file" accept=".zip,.rar,.cbz,.cbr" style="display: none;">
                    <div id="fileInfo" class="file-info" style="display: none;"></div>
                </div>
                <div class="progress-bar" id="uploadProgress">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <button type="submit" class="btn btn-success" id="uploadBtn">上传漫画</button>
                <button type="button" class="btn btn-warning" onclick="resetForm()">重置</button>
            </form>
        </section>
        <!-- 漫画管理 -->
        <section id="manga" class="admin-section tab-content">
            <h2 class="section-title">漫画管理</h2>
            <div id="manageError" class="error-message"></div>

            <div class="search-box" style="margin-bottom: 20px; display: flex; gap: 10px; align-items: center;">
                <input type="text" id="searchInput" placeholder="搜索漫画名称或作者..."
                       style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 25px; font-size: 14px;">
                <button class="btn btn-primary" onclick="searchManga()" style="padding: 12px 20px;">搜索</button>
                <button class="btn btn-warning" onclick="resetSearch()" style="padding: 12px 20px;">重置</button>
            </div>

            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th width="80">封面</th>
                            <th>漫画名称</th>
                            <th width="120">作者</th>
                            <th width="120">上传时间</th>
                            <th width="100">文件大小</th>
                            <th width="150">标签</th>
                            <th width="200">操作</th>
                        </tr>
                    </thead>
                    <tbody id="mangaList">
                        <tr>
                            <td colspan="7" class="loading">加载中...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- 分页控件 -->
            <div class="admin-pagination">
                <div class="pagination-info" id="paginationInfo">
                    显示 0-0 条，共 0 条
                </div>
                <div class="pagination-controls">
                    <button class="page-btn" onclick="goToPage(1)" id="firstPage" disabled>首页</button>
                    <button class="page-btn" onclick="previousPage()" id="prevPage" disabled>上一页</button>

                    <span>第</span>
                    <input type="number" class="page-input" id="currentPageInput" min="1" value="1"
                           onchange="goToPage(parseInt(this.value))">
                    <span>页</span>

                    <button class="page-btn" onclick="nextPage()" id="nextPage" disabled>下一页</button>
                    <button class="page-btn" onclick="goToPage(totalPages)" id="lastPage" disabled>末页</button>

                    <select class="page-size-select" id="pageSizeSelect" onchange="changePageSize(parseInt(this.value))">
                        <option value="10">10条/页</option>
                        <option value="20">20条/页</option>
                        <option value="50">50条/页</option>
                        <option value="100">100条/页</option>
                    </select>
                </div>
            </div>
        </section>
        <!-- 轮播图管理 -->
        <section id="carousel" class="admin-section tab-content">
            <h2 class="section-title">轮播图管理</h2>
            <div id="carouselError" class="error-message"></div>
            
            <!-- 上传轮播图表单 -->
            <div class="form-section">
                <h3>上传新轮播图</h3>
                <form id="carouselUploadForm">
                    <div class="form-group">
                        <label for="carouselTitle">标题</label>
                        <input type="text" id="carouselTitle" placeholder="输入轮播图标题">
                    </div>
                    <div class="form-group">
                        <label for="carouselLink">链接地址 (可选)</label>
                        <input type="text" id="carouselLink" placeholder="http://example.com 或 /manga-detail.html?id=123">
                    </div>
                    <div class="form-group">
                        <label for="carouselSortOrder">排序 (数字越小越靠前)</label>
                        <input type="number" id="carouselSortOrder" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="carouselImage">轮播图图片</label>
                        <div class="upload-area" id="carouselUploadArea" onclick="document.getElementById('carouselImage').click()">
                            <i>📁</i>
                            <p>点击上传图片 (JPG, PNG, GIF, WebP)</p>
                            <p>建议尺寸: 1200x400 或更大</p>
                        </div>
                        <input type="file" id="carouselImage" name="image" accept="image/*" style="display: none;">
                        <div id="carouselImageInfo" class="file-info" style="display: none;"></div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="carouselActive" checked> 启用显示
                        </label>
                    </div>
                    <button type="submit" class="btn btn-success">上传轮播图</button>
                    <button type="button" class="btn btn-warning" onclick="resetCarouselForm()">重置</button>
                </form>
            </div>
            
            <!-- 轮播图列表 -->
            <div class="form-section">
                <h3>轮播图列表</h3>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th width="80">预览</th>
                                <th>标题</th>
                                <th width="150">链接</th>
                                <th width="100">排序</th>
                                <th width="80">状态</th>
                                <th width="150">操作</th>
                            </tr>
                        </thead>
                        <tbody id="carouselList">
                            <tr>
                                <td colspan="6" class="loading">加载中...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        
        <!-- 标签管理 -->
        <section id="tags" class="admin-section tab-content">
            <h2 class="section-title">标签管理</h2>
            <div id="tagsError" class="error-message"></div>
            <div class="form-group">
                <label for="namespaceSelect">选择标签分类</label>
                <select id="namespaceSelect" onchange="loadTags()">
                    <option value="">选择分类...</option>
                </select>
            </div>
            <div class="form-group">
                <label for="tagName">标签名称</label>
                <input type="text" id="tagName" placeholder="输入新标签名称">
            </div>
            <div class="form-group">
                <label for="tagSlug">标签标识 (英文，用于URL)</label>
                <input type="text" id="tagSlug" placeholder="输入标签标识，如：romance">
            </div>
            <div class="form-group">
                <label for="tagDescription">标签描述</label>
                <textarea id="tagDescription" placeholder="输入标签描述信息"></textarea>
            </div>
            <button class="btn btn-success" onclick="createTag()">创建标签</button>
            <button class="btn btn-warning" onclick="createNamespace()">创建标签分类</button>
            <h3 style="margin-top: 30px;">标签列表</h3>
            <div id="tagList" class="tag-list">
                <!-- 标签列表将通过JavaScript动态生成 -->
            </div>
        </section>
    </main>
    <!-- 章节管理模态框 -->
    <div id="chapterModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeChapterModal()">&times;</span>
            <h2>章节管理 - <span id="mangaTitle"></span></h2>
            <div class="form-group">
                <label for="chapterTitle">章节标题 *</label>
                <input type="text" id="chapterTitle" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="chapterNumber">章节编号 *</label>
                <input type="number" id="chapterNumber" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="chapterFile">章节文件 *</label>
                <input type="file" id="chapterFile" class="form-control" accept=".zip,.cbz" required>
            </div>
            <button class="btn btn-success" onclick="addChapter()">添加章节</button>
            <h3 style="margin-top: 30px;">现有章节</h3>
            <div id="chapterList" class="chapter-list">
                <!-- 章节列表将通过JavaScript动态生成 -->
            </div>
        </div>
    </div>
    <!-- 编辑章节模态框 -->
    <div id="editChapterModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditChapterModal()">&times;</span>
            <h2>编辑章节</h2>
            <input type="hidden" id="editChapterId">
            <div class="form-group">
                <label for="editChapterTitle">章节标题 *</label>
                <input type="text" id="editChapterTitle" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="editChapterNumber">章节编号 *</label>
                <input type="number" id="editChapterNumber" class="form-control" required>
            </div>
            <button class="btn btn-warning" onclick="updateChapter()">更新章节</button>
        </div>
    </div>
    <!-- 编辑漫画模态框 -->
    <div id="editMangaModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditMangaModal()">&times;</span>
            <h2>编辑漫画</h2>
            <input type="hidden" id="editMangaId">
            <div class="form-group">
                <label for="editMangaTitle">漫画名称 *</label>
                <input type="text" id="editMangaTitle" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="editMangaAuthor">作者 *</label>
                <input type="text" id="editMangaAuthor" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="editMangaDescription">漫画简介</label>
                <textarea id="editMangaDescription" class="form-control"></textarea>
            </div>
            <!-- 编辑漫画标签 -->
            <div class="form-group">
                <label>编辑标签</label>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <select id="editTagSelect" style="flex: 1;">
                        <option value="">选择标签...</option>
                    </select>
                    <button type="button" class="btn btn-info" onclick="addTagToEditManga()">添加标签</button>
                </div>
                <div id="editMangaTags" class="manga-tags" style="margin-top: 10px;">
                    <!-- 标签将动态添加 -->
                </div>
            </div>
            <div class="form-group">
                <label for="editMangaCover">封面图片 (可选)</label>
                <input type="file" id="editMangaCover" class="form-control" accept="image/*">
                <small>留空则不修改当前封面</small>
            </div>
            <button class="btn btn-warning" onclick="updateManga()">更新漫画</button>
        </div>
    </div>
    <!-- 标签分类管理模态框 -->
    <div id="namespaceModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeNamespaceModal()">&times;</span>
            <h2>创建标签分类</h2>
            <div class="form-group">
                <label for="namespaceName">分类名称</label>
                <input type="text" id="namespaceName" placeholder="输入分类名称，如：type">
            </div>
            <div class="form-group">
                <label for="namespaceDisplayName">显示名称</label>
                <input type="text" id="namespaceDisplayName" placeholder="输入显示名称，如：创作类型">
            </div>
            <div class="form-group">
                <label for="namespaceDescription">分类描述</label>
                <textarea id="namespaceDescription" placeholder="输入分类描述信息"></textarea>
            </div>
            <button class="btn btn-success" onclick="createNamespaceFromModal()">创建分类</button>
        </div>
    </div>



</body>

<script src="admin-script.js"></script>
</html>
